---
layout: post
title:  "Transient MKS with Varied Initial Conditions"
subtitle: "Multiple Initial Conditions"
author: David Brough
categories: post
---
{% include latex.html %}

Once again from the top.

I create 500 random initial microstructures (100 x 100). Each
microstructures was generated by sampling a normal distribution with
a standard deviation of 1e-2. The mean of the normal distribution
was randomly selected between the interval of [-0.2, 0.2] for each
of the microstructures. Each was evolved by solving the Cahn-Hilliard equation for
500 time steps to get an initial microstructure and final microstructure
as inputs and outputs for the MKS calibration.

Here is a picture of one instance of calibration inputs and outputs.

![](https://farm1.staticflickr.com/472/19508872363_b4067f72ab_z_d.jpg)

Next, the same cross validation procedure as mentioned in the paper was
used, and here is the result.

![](https://farm1.staticflickr.com/550/19508872143_825d10fc17_o_d.png)

Now that the initial conditions are varied, the Legendre basis out
preforms the Primitive basis after we have chosen $L => 4$.

I then calibrated two models, one for the Primitive basis one for the
Legendre Basis each with 4 local states.

The influence coefficients for these models were different from what I
have seen before. Depending on the domain size, influence coefficients
for the Legendre model were sometime complex after the inverse
FFT. From the small number of domains that I tried, I noticed that if
the domain size was even (100 x 100) the coefficients were real and
complex if the domain size was odd (101 x 101). The Primitive model
always had complex influence coefficients after the inverse FFT
regardless of the domain size. This is a little troubling because
if I were to calibrate these coefficients without using FFTs, they
should be real.

Below are the real components of the influence coefficients for the
primitive basis.

![](https://farm1.staticflickr.com/412/19941829710_3e70a241ee_z_d.jpg)

Here are the corresponding imaginary components of the influence
coefficients from the model with the primitive basis.

![](https://farm1.staticflickr.com/295/19941753178_c55641e248_z_d.jpg)

Here are the real valued influenced coefficients for the model with
the Legendre basis.

![](https://farm1.staticflickr.com/437/19943179409_c8e2101f53_z_d.jpg)

Next, I create 500 new initial random microstructures using the same
procedure as noted above. These same microstructures were evolved using:
500 time tests with the simulation, with one large multi-step using
the MKS linkages, and for reference with one large step equal to the
multi-step using the simulation.

Here is a picture of one of the initial microstructures.

![](https://farm1.staticflickr.com/273/19943179679_5d0e124cc2_o_d.png)

Here are the results

![](https://farm1.staticflickr.com/392/20103576066_a6fce4fd36_b_d.jpg)

Here are the mean run time for each of the microstructures

 - Simulation 500 time steps - 1.20 sec
 - Simulation 1 time step - 2.39e-3 sec
 - Primitive Basis - 2.19e-3 sec
 - Legendre Basis - 2.49e-3 sec

 The normalized MSE value for both the MKS models with respect to the
 simulation are

  - Simulation 1 time step - 3.21e-6
  - Primitive - 3.00e-7
  - Legendre - 3.93e-8

Below are the difference plots.

![](https://farm1.staticflickr.com/371/19942247408_11bd493ee4_b_d.jpg)

The same trends were present when I increased the size of the domains
from 100 x 100 to 300 x 300, and used the same process to compute the
structure evolution of new large microstructure.
